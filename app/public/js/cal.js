let calMenu = {
    25: {
        "name": "25-कालदर्शिका",
        "description": "6 Sheets | 11 inch x 18 inch",
        "fromprice": "20.95",
        "fromqty": "1000",
        "toprice": "46.32",
        "toqty": "250"
    },
    31: {
        "name": "31-उमंग",
        "description": "6 Sheets | 11 inch x 18 inch",
        "fromprice": "20.95",
        "fromqty": "1000",
        "toprice": "46.32",
        "toqty": "250"
    },
    35: {
        "name": "35-Tarang",
        "description": "6 Sheets | 11 inch x 18 inch",
        "fromprice": "22.13",
        "fromqty": "1000",
        "toprice": "47.50",
        "toqty": "250"

    },
    37: {
        "name": "37-Sarang",
        "description": "6 Sheets | 11 inch x 18 inch",
        "fromprice": "22.13",
        "fromqty": "1000",
        "toprice": "47.50",
        "toqty": "250"
    },
    51: {
        "name": "51-नवनिर्णय",
        "description": "6 Sheets | 14.5 inch x 19 inch",
        "fromprice": "29.50",
        "fromqty": "1000",
        "toprice": "48.97",
        "toqty": "250"
    },
    55: {
        "name": "55-Stride",
        "description": "6 Sheets | 14.5 inch x 19 inch",
        "fromprice": "29.50",
        "fromqty": "1000",
        "toprice": "57.23",
        "toqty": "250"
    },
    111: {
        "name": "111-Grace",
        "description": "12 Sheets | 14.5 inch x 19 inch",
        "fromprice": "41.30",
        "fromqty": "1000",
        "toprice": "102.66",
        "toqty": "100"
    },
    141: {
        "name": "141-Bright",
        "description": "12 Sheets | 14.5 inch x 19 inch",
        "fromprice": "41.30",
        "fromqty": "1000",
        "toprice": "102.66",
        "toqty": "100",
    },
    161: {
        "name": "161-Smash",
        "description": "6 Sheets & 12 Sheets | 17.5 inch x 22.5 inch",
        "fromprice": "40.12",
        "fromqty": "(6 Sheets) 1000",
        "toprice": "86.44",
        "toqty": "(12 Sheets) 250"
    },
    81: {
        "name": "81-Spark",
        "description": "6 Sheets | 14.5 inch x 19 inch",
        "fromprice": "28.32",
        "fromqty": "1000",
        "toprice": "56.05",
        "toqty": "250",
    },
    171: {
        "name": "171-Majestic",
        "description": "6 Sheets & 12 Sheets | 19 inch x 29 inch",
        "fromprice": "51.92",
        "fromqty": "(6 Sheets) 1000",
        "toprice": "133.34",
        "toqty": "(12 Sheets) 100"
    },
    181: {
        "name": "181-Classic",
        "description": "6 Sheets & 12 Sheets | 19 inch x 29 inch",
        "fromprice": "62.54",
        "fromqty": "(6 Sheets) 1000",
        "toprice": "143.96",
        "toqty": "(12 Sheets) 100",
    },
    131: {
        "name": "131-Serene",
        "description": "6 Sheets | 19 inch x 29 inch",
        "fromprice": "41.30",
        "fromqty": "1000",
        "toprice": "102.66",
        "toqty": "100"
    },
    91: {
        "name": "91-Glimpse",
        "description": "4 Sheets | 19 inch x 29 inch",
        "fromprice": "33.34",
        "fromqty": "1000",
        "toprice": "56.94",
        "toqty": "250"
    },
    27: {
        "name": "27-जीवन अमृत",
        "description": "6 Sheets | 11 inch x 18 inch",
        "fromprice": "33.34",
        "fromqty": "1000",
        "toprice": "67.26",
        "toqty": "150"
    },
    17: {
        "name": "17-Seasons",
        "description": "6 Sheets | 5 inch x 10 inch",
        "fromprice": "12.39",
        "fromqty": "1000",
        "toprice": "24.07",
        "toqty": "500"
    }
};

let menu = {
    25: {
        "name": "25-कालदर्शिका",
        6: {
            250: {
                "baseRate": 22,
                "extraRate": 5.75
            },
            500: {
                "baseRate": 19.25,
                "extraRate": 3.25
            },
            1000: {
                "baseRate": 17.75,
                "extraRate": 2
            }
        }
    },
    31: {
        "name": "31-उमंग",
        6: {
            250: {
                "baseRate": 22,
                "extraRate": 5.75
            },
            500: {
                "baseRate": 19.25,
                "extraRate": 3.25
            },
            1000: {
                "baseRate": 17.75,
                "extraRate": 2
            }
        }
    },
    35: {
        "name": "35-Tarang",
        6: {
            250: {
                "baseRate": 23,
                "extraRate": 5.75
            },
            500: {
                "baseRate": 20.25,
                "extraRate": 3.25
            },
            1000: {
                "baseRate": 18.75,
                "extraRate": 2
            }
        }
    },
    37: {
        "name": "37-Sarang",
        6: {
            250: {
                "baseRate": 23,
                "extraRate": 5.75
            },
            500: {
                "baseRate": 20.25,
                "extraRate": 3.25
            },
            1000: {
                "baseRate": 18.75,
                "extraRate": 2
            }
        }
    },
    51: {
        "name": "51-नवनिर्णय",
        6: {
            250: {
                "baseRate": 22,
                "extraRate": 6.5
            },
            500: {
                "baseRate": 26.25,
                "extraRate": 3.75
            },
            1000: {
                "baseRate": 25,
                "extraRate": 2.65
            }
        }
    },
    55: {
        "name": "55-Stride",
        6: {
            250: {
                "baseRate": 29,
                "extraRate": 6.5
            },
            500: {
                "baseRate": 26.25,
                "extraRate": 3.75
            },
            1000: {
                "baseRate": 25,
                "extraRate": 2.65
            }
        }
    },
    111: {
        "name": "111-Grace",
        12: {
            100: {
                "baseRate": 46.5,
                "extraRate": 13.5
            },
            250: {
                "baseRate": 39,
                "extraRate": 6.5
            },
            500: {
                "baseRate": 36.25,
                "extraRate": 3.75
            },
            1000: {
                "baseRate": 35,
                "extraRate": 2.6
            }
        }
    },
    141: {
        "name": "141-Bright",
        12: {
            100: {
                "baseRate": 46.5,
                "extraRate": 13.5
            },
            250: {
                "baseRate": 39,
                "extraRate": 6.5
            },
            500: {
                "baseRate": 36.25,
                "extraRate": 3.75
            },
            1000: {
                "baseRate": 35,
                "extraRate": 2.6
            }
        }
    },
    161: {
        "name": "161-Smash",
        6: {
            250: {
                "baseRate": 38,
                "extraRate": 7.5
            },
            500: {
                "baseRate": 35.75,
                "extraRate": 5.5
            },
            1000: {
                "baseRate": 34,
                "extraRate": 3.6
            }
        },
        12: {
            250: {
                "baseRate": 51.5,
                "extraRate": 7.25
            },
            500: {
                "baseRate": 49.25,
                "extraRate": 5.25
            },
            1000: {
                "baseRate": 47.5,
                "extraRate": 3.6
            }
        }
    },
    81: {
        "name": "81-Spark",
        6: {
            250: {
                "baseRate": 28,
                "extraRate": 6.5
            },
            500: {
                "baseRate": 25,
                "extraRate": 3.75
            },
            1000: {
                "baseRate": 24,
                "extraRate": 2.6
            }
        }
    },
    171: {
        "name": "171-Majestic",
        6: {
            250: {
                "baseRate": 48,
                "extraRate": 7.5
            },
            500: {
                "baseRate": 45.75,
                "extraRate": 5.5
            },
            1000: {
                "baseRate": 44,
                "extraRate": 3.6
            }
        },
        12: {
            100: {
                "baseRate": 72.5,
                "extraRate": 13.5
            },
            250: {
                "baseRate": 66,
                "extraRate": 7.25
            },
            500: {
                "baseRate": 63.75,
                "extraRate": 5.25
            },
            1000: {
                "baseRate": 62,
                "extraRate": 3.6
            }
        }
    },
    181: {
        "name": "181-Classic",
        6: {
            250: {
                "baseRate": 57,
                "extraRate": 7.5
            },
            500: {
                "baseRate": 54.75,
                "extraRate": 5.5
            },
            1000: {
                "baseRate": 53,
                "extraRate": 3.6
            }
        },
        12: {
            100: {
                "baseRate": 81.5,
                "extraRate": 13.5
            },
            250: {
                "baseRate": 75,
                "extraRate": 7.25
            },
            500: {
                "baseRate": 72.75,
                "extraRate": 5.25
            },
            1000: {
                "baseRate": 71,
                "extraRate": 3.6
            }
        }
    },
    131: {
        "name": "131-Serene",
        6: {
            100: {
                "baseRate": 46.5,
                "extraRate": 13.5
            },
            250: {
                "baseRate": 39,
                "extraRate": 6.5
            },
            500: {
                "baseRate": 36,
                "extraRate": 3.75
            },
            1000: {
                "baseRate": 35,
                "extraRate": 2.6
            }
        }
    },
    91: {
        "name": "91-Glimpse",
        4: {
            250: {
                "baseRate": 31.75,
                "extraRate": 5.5
            },
            500: {
                "baseRate": 29.25,
                "extraRate": 3.25
            },
            1000: {
                "baseRate": 28.25,
                "extraRate": 2.25
            }
        }
    },
    27: {
        "name": "27-जीवन अमृत",
        6: {
            150: {
                "baseRate": 27,
                "extraRate": 10
            },
            250: {
                "baseRate": 23,
                "extraRate": 5.75
            },
            500: {
                "baseRate": 20.25,
                "extraRate": 3.25
            },
            1000: {
                "baseRate": 18.75,
                "extraRate": 2
            }
        }
    },
    17: {
        "name": "17-Seasons",
        6: {
            500: {
                "baseRate": 12,
                "extraRate": 2.8
            },
            1000: {
                "baseRate": 10.5,
                "extraRate": 1.4
            }
        }
    }
};
let pageOptionsSel = 6;
let inksSel = 1;
let calID;

let unHover = "background-color: #f0f0f0;";
let hoverStyle = " background: rgb(214,248,255); background: -moz-linear-gradient(180deg, rgba(214,248,255,0.7) 0%, rgba(208,243,250,0.7) 60%, rgba(174,232,245,0.7) 100%); background: -webkit-linear-gradient(180deg, rgba(214,248,255,0.7) 0%, rgba(208,243,250,0.7) 60%, rgba(174,232,245,0.7) 100%); background: linear-gradient(180deg, rgba(214,248,255,0.7) 0%, rgba(208,243,250,0.7) 60%, rgba(174,232,245,0.7) 100%); filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#d6f8ff',endColorstr='#aee8f5',GradientType=1);";
let inactiveButton = "background: #c0c0c0;";
let activeButton = "background: rgb(244,174,94); background: -moz-linear-gradient(180deg, rgba(244,174,94,1) 0%, rgba(230,147,11,1) 50%, rgba(224,133,15,1) 100%); background: -webkit-linear-gradient(180deg, rgba(244,174,94,1) 0%, rgba(230,147,11,1) 50%, rgba(224,133,15,1) 100%); background: linear-gradient(180deg, rgba(244,174,94,1) 0%, rgba(230,147,11,1) 50%, rgba(224,133,15,1) 100%); filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#f4ae5e',endColorstr='#e0850f,GradientType=1);";
let minQty;

let due;
let orderQty;

function callCalID() {
    const queryString = window.location.search;
    console.log(queryString);
    const urlParams = new URLSearchParams(queryString);
    calID = JSON.parse(urlParams.get('calID'));
    console.log(urlParams.get('calID'));
    console.log(calID);
    document.getElementById('calendar-name').innerHTML = calMenu[calID].name;
    // document.getElementById('cal-img').setAttribute('src', '/image/calendarpngfiles/' + calID + '.png');
    document.getElementById('cal-img').setAttribute('src', '/image/temps/' + calID + '.jpg');
    document.getElementById('description').innerHTML = calMenu[calID].description;

    document.getElementById('sheets-6').style.display = 'none';
    document.getElementById('sheets-12').style.display = 'none';
    document.getElementById('sheets-4').style.display = 'none';

    if (menu[calID][6] != null) { //6 sheets option available
        pageOptionsSel = 6;
        document.getElementById('sheets-6').style = hoverStyle;
    }
    if (menu[calID][12] != null) { // 12 sheets option
        pageOptionsSel = 12;
        document.getElementById('sheets-12').style = hoverStyle;
    }
    if (menu[calID][12] != null && menu[calID][6] != null) { // 12 sheets option
        document.getElementById('sheets-12').style = hoverStyle;
        document.getElementById('sheets-6').style = unHover;
        pageOptionsSel = 12;
    }
    if (menu[calID][4] != null) { //4 sheets option
        document.getElementById('sheets-4').style = hoverStyle;
        pageOptionsSel = 4;
    }
    pageOptionSelection();

   
    if (calID == 171 || calID == 181) {
        document.getElementById('cal-qty').setAttribute('value', '100');
        document.getElementById('cal-qty').setAttribute('min', '100');
        document.getElementById('total-for-qty').innerHTML = "including GST, <br> for " + '100' + " copies";
        document.getElementById('min-qty-h3').innerHTML = "Enter quantity (min. " + '100' + ")";
        minQty = 100;
    } else if (calID == 161) {
        document.getElementById('cal-qty').setAttribute('value', '250');
        document.getElementById('cal-qty').setAttribute('min', '250');
        document.getElementById('total-for-qty').innerHTML = "including GST, <br> for " + '250' + " copies";
        document.getElementById('min-qty-h3').innerHTML = "Enter quantity (min. " + '250' + ")";
        minQty = 250;
    }
     else {
        document.getElementById('cal-qty').setAttribute('value', JSON.parse(calMenu[calID].toqty));
        document.getElementById('cal-qty').setAttribute('min', JSON.parse(calMenu[calID].toqty));
        document.getElementById('total-for-qty').innerHTML = "including GST, <br> for " + (calMenu[calID].toqty) + " copies";
        document.getElementById('min-qty-h3').innerHTML = "Enter quantity (min. " + (calMenu[calID].toqty) + ")";
        minQty = JSON.parse(calMenu[calID].toqty);
    }

    inksSelection(1);
    calAdv(minQty);
}

function pageSel(option) {
    pageOptionsSel = option;
    if (menu[calID][4] != null) {
        document.getElementById('sheets-4').style = unHover;
    }
    if (menu[calID][6] != null) {
        document.getElementById('sheets-6').style = unHover;
    }
    if (menu[calID][12] != null) {
        document.getElementById('sheets-12').style = unHover;
    }

    pageOptionSelection();

    document.getElementById('sheets-' + pageOptionsSel).style = hoverStyle;

    if (calID == 171 || calID == 181) {
        if (option == 6) {
            document.getElementById('cal-qty').setAttribute('value', '250');
            document.getElementById('cal-qty').setAttribute('min', '250');
            document.getElementById('total-for-qty').innerHTML = "including GST, <br> for " + '250' + " copies";
            document.getElementById('min-qty-h3').innerHTML = "Enter quantity (min. " + '250' + ")";
            minQty = 250;
        }
        if (option == 12) {
            document.getElementById('cal-qty').setAttribute('value', '100');
            document.getElementById('cal-qty').setAttribute('min', '100');
            document.getElementById('total-for-qty').innerHTML = "including GST, <br> for " + '100' + " copies";
            document.getElementById('min-qty-h3').innerHTML = "Enter quantity (min. " + '100' + ")";
            minQty = 100;
        }
    }

    calAdv(document.getElementById('cal-qty').value);
}

function pageOptionSelection() {
    if (pageOptionsSel == 6) {
        document.getElementById('rate-table-h3').innerHTML = "Single Sided (6 Sheets) calendar bulk prices";
    }
    if (pageOptionsSel == 12) {
        document.getElementById('rate-table-h3').innerHTML = "Double Sided (12 Sheets) calendar bulk prices";
    }
    if (pageOptionsSel == 4) {
        document.getElementById('rate-table-h3').innerHTML = "Single Sided (4 Sheets) calendar bulk prices";
    }

    document.getElementById('4-sheets-table').style.display = 'none';
    document.getElementById('6-sheets-table').style.display = 'none';
    document.getElementById('12-sheets-table').style.display = 'none';
    document.getElementById(pageOptionsSel + '-sheets-table').style.display = 'block';


    for (let i = 1; i <= 1000; i++) {
        if (menu[calID][pageOptionsSel][i] != null) {
            document.getElementById('base-' + pageOptionsSel + '-' + i).innerHTML = Math.round((menu[calID][pageOptionsSel][i].baseRate * 1.18 + Number.EPSILON) * 100) / 100; //Math.round((roundAmount + roundGst + Number.EPSILON) * 100) / 100;
            document.getElementById('extra-' + pageOptionsSel + '-' + i).innerHTML = Math.round((menu[calID][pageOptionsSel][i].extraRate * 1.18 + Number.EPSILON) * 100) / 100; //Math.round((roundAmount + roundGst + Number.EPSILON) * 100) / 100;
        }
    }
    for (let i = 0; i <= 4; i++) {
        let pageSelArray = [100, 150, 250, 500, 1000];
        if (menu[calID][pageOptionsSel][pageSelArray[i]] == null) {
            document.getElementById('table-' + pageOptionsSel + '-' + pageSelArray[i]).style.display = 'none';
        }
    }

}

function inksSelection(x) {
    inksSel = x;
    document.getElementById('inks-1').style = unHover;
    document.getElementById('inks-2').style = unHover;
    document.getElementById('inks-3').style = unHover;
    document.getElementById('inks-' + inksSel).style = hoverStyle;
    calAdv(document.getElementById('cal-qty').value);
}

// function runQtyCheck() {
// if ( document.getElementById('cal-qty').getAttribute('value') != minQty) {
// document.getElementById('qty-error').style.display= 'block';
// document.getElementById('cal-qty').style.backgroundColor = 'rgb(255, 192, 192)';
// }
// else{
// document.getElementById('qty-error').style.display= 'none';
// document.getElementById('cal-qty').style.backgroundColor = '#fff';
// }
// console.log('one key up');
// }

document.getElementById('cal-qty').onkeyup = function () {
    let a = document.getElementById('total-amount');
    let d = document.getElementById('due-amount');
    if (document.getElementById('cal-qty').value < minQty) {
        a.innerHTML = "Rs. &#8212;";
        d.innerHTML = "Rs. &#8212;";
        document.getElementById('qty-error').style.display='block';
        document.getElementById('order-button1').style = inactiveButton;
        document.getElementById('qty-error').innerHTML='Please enter quantity <br> greater than ' + minQty;
        document.getElementById('cal-qty').style = "background: #fff7f7;";
    }
    if (document.getElementById('cal-qty').value >= minQty) {
        document.getElementById('order-button1').style = activeButton;
        calAdv(document.getElementById('cal-qty').value);
        document.getElementById('cal-qty').style = "background: #fff;";
        document.getElementById('qty-error').style.display='none';
    }

    console.log('one key up');
};

function calAdv(q){
    let a = document.getElementById('total-amount');
    let d = document.getElementById('due-amount');
    let sheetsChoice = pageOptionsSel;
    let calNum = calID;
    let qty = q;
    let inksChoice = inksSel;

    if (qty > 99 && qty < 250 && menu[calNum][sheetsChoice][100] != null) {
        qtyChoice = 100;
    }
    else if(qty > 149 && qty < 250 && menu[calNum][sheetsChoice][150] != null){
        qtyChoice = 150;
    }
    else if (qty > 249 && qty < 500 && menu[calNum][sheetsChoice][250] != null){
        qtyChoice = 250;
    }
    else if (qty > 499 && qty < 1000 && menu[calNum][sheetsChoice][500] != null){
        qtyChoice = 500;
    }
    else if (qty > 999 && menu[calNum][sheetsChoice][1000] != null){
        qtyChoice = 1000;
    }
    
    console.log(menu[calNum][sheetsChoice][qtyChoice]);
    console.log(menu[calNum].name + " " + sheetsChoice + " " + qty + " " + qtyChoice + " " + inksChoice);

    let amount = qty* (menu[calNum][sheetsChoice][qtyChoice].baseRate + ((inksChoice-1)* menu[calNum][sheetsChoice][qtyChoice].extraRate));
    let roundAmount = Math.round((amount + Number.EPSILON) * 100) / 100;
    let gst = roundAmount * 0.18;
    roundGst = Math.round((gst + Number.EPSILON) * 100) / 100;
    let totalAmount = (Math.round((roundAmount + roundGst + Number.EPSILON) * 100) / 100).toFixed(2);
    let advanceDue = (0.5 * totalAmount).toFixed(2);
    if(advanceDue < 5000){
        advanceDue = 5000;
    }
    due = advanceDue*100;
    orderQty = qty;
    a.innerHTML = "Rs. " + totalAmount;
    d.innerHTML = "Rs. " + advanceDue;
    document.getElementById('total-for-qty').innerHTML = "including GST, <br> for " + qty + " copies";
    console.log("Total without GST: " + roundAmount);
    console.log("GST: " + roundGst);
    console.log("Total: " + totalAmount);
    console.log("Advance: " + advanceDue);
}

